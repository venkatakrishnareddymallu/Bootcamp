!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.g1=t.g1||{})}(this,function(t){"use strict";var R="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function e(t,e){return t(e={exports:{}},e.exports),e.exports}var U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t){return function(){var s=t.apply(this,arguments);return new Promise(function(i,a){return function e(t,r){try{var n=s[t](r),o=n.value}catch(t){return void a(t)}if(!n.done)return Promise.resolve(o).then(function(t){e("next",t)},function(t){e("throw",t)});i(o)}("next")})}};e(function(t,e){t.exports=function(){function u(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,e=void 0,o=void 0,s=function(t,e){f[n]=t,f[n+1]=e,2===(n+=2)&&(o?o(d):m())},t="undefined"!=typeof window?window:void 0,i=t||{},a=i.MutationObserver||i.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var t=setTimeout;return function(){return t(d,1)}}var f=new Array(1e3);function d(){for(var t=0;t<n;t+=2){var e=f[t],r=f[t+1];e(r),f[t]=void 0,f[t+1]=void 0}n=0}var v,h,y,b,m=void 0;function g(t,e){var r=this,n=new this.constructor(j);void 0===n[_]&&K(n);var o=r._state;if(o){var i=arguments[o-1];s(function(){return D(o,n,i,r._result)})}else C(r,n,t,e);return n}function w(t){if(t&&"object"===(void 0===t?"undefined":U(t))&&t.constructor===this)return t;var e=new this(j);return x(e,t),e}c?m=function(){return process.nextTick(d)}:a?(h=0,y=new a(d),b=document.createTextNode(""),y.observe(b,{characterData:!0}),m=function(){b.data=h=++h%2}):l?((v=new MessageChannel).port1.onmessage=d,m=function(){return v.port2.postMessage(0)}):m=void 0===t?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(d)}:p()}catch(t){return p()}}():p();var _=Math.random().toString(36).substring(2);function j(){}var L=void 0,E=1,O=2,A={error:null};function T(t){try{return t.then}catch(t){return A.error=t,A}}function S(t,e,r){var n,o,i,a;e.constructor===t.constructor&&r===g&&e.constructor.resolve===w?(i=t,(a=e)._state===E?k(i,a._result):a._state===O?M(i,a._result):C(a,void 0,function(t){return x(i,t)},function(t){return M(i,t)})):r===A?(M(t,A.error),A.error=null):void 0===r?k(t,e):u(r)?(n=e,o=r,s(function(e){var r=!1,t=function(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}(o,n,function(t){r||(r=!0,n!==t?x(e,t):k(e,t))},function(t){r||(r=!0,M(e,t))},e._label);!r&&t&&(r=!0,M(e,t))},t)):k(t,e)}function x(t,e){var r,n;t===e?M(t,new TypeError("You cannot resolve a promise with itself")):(n=void 0===(r=e)?"undefined":U(r),null===r||"object"!==n&&"function"!==n?k(t,e):S(t,e,T(e)))}function P(t){t._onerror&&t._onerror(t._result),F(t)}function k(t,e){t._state===L&&(t._result=e,t._state=E,0!==t._subscribers.length&&s(F,t))}function M(t,e){t._state===L&&(t._state=O,t._result=e,s(P,t))}function C(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+E]=r,o[i+O]=n,0===i&&t._state&&s(F,t)}function F(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)n=e[a],o=e[a+r],n?D(r,n,o,i):o(i);t._subscribers.length=0}}function D(t,e,r,n){var o=u(r),i=void 0,a=void 0,s=void 0,c=void 0;if(o){if((i=function(t,e){try{return t(e)}catch(t){return A.error=t,A}}(r,n))===A?(c=!0,a=i.error,i.error=null):s=!0,e===i)return void M(e,new TypeError("A promises callback cannot return that same promise."))}else i=n,s=!0;e._state!==L||(o&&s?x(e,i):c?M(e,a):t===E?k(e,i):t===O&&M(e,i))}var z=0;function K(t){t[_]=z++,t._state=void 0,t._result=void 0,t._subscribers=[]}var N=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(j),this.promise[_]||K(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&k(this.promise,this._result))):M(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===L&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===w){var o=T(e);if(o===g&&e._state!==L)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===I){var i=new r(j);S(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},t.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===L&&(this._remaining--,t===O?M(n,r):this._result[e]=r),0===this._remaining&&k(n,this._result)},t.prototype._willSettleAt=function(t,e){var r=this;C(t,void 0,function(t){return r._settledAt(E,e,t)},function(t){return r._settledAt(O,e,t)})},t}(),I=function(){function e(t){this[_]=z++,this._result=this._state=void 0,this._subscribers=[],j!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){x(e,t)},function(t){M(e,t)})}catch(t){M(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var r=this.constructor;return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})})},e}();return I.prototype.then=g,I.all=function(t){return new N(this,t).promise},I.race=function(o){var i=this;return r(o)?new i(function(t,e){for(var r=o.length,n=0;n<r;n++)i.resolve(o[n]).then(t,e)}):new i(function(t,e){return e(new TypeError("You must pass an array to race."))})},I.resolve=w,I.reject=function(t){var e=new this(j);return M(e,t),e},I._setScheduler=function(t){o=t},I._setAsap=function(t){s=t},I._asap=s,I.polyfill=function(){var t=void 0;if(void 0!==R)t=R;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=I},I.Promise=I}()}).polyfill();!function o(i,a,s){function c(r,t){if(!a[r]){if(!i[r]){if(!t&&l)return l(r,!0);if(u)return u(r,!0);var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}var n=a[r]={exports:{}};i[r][0].call(n.exports,function(t){var e=i[r][1][t];return c(e||t)},n,n.exports,o,i,a,s)}return a[r].exports}for(var u=l,t=0;t<s.length;t++)c(s[t]);return c}({1:[function(t,e,r){e.exports=function(){"undefined"==typeof EventTarget&&(window.EventTarget=Node);var t={interceptors:[],getRegisteredEventListener:function(t,e){var r=e.type+"-"+(e.options.capture?"1":"0");if(void 0!==t.__eventListeners&&void 0!==t.__eventListeners[r])for(var n=t.__eventListeners[r],o=0;o<n.length;o++)if(n[o].listener===e.listener)return n[o];return null},registerEventListener:function(t,e){var r=e.type+"-"+(e.options.capture?"1":"0");void 0===t.__eventListeners&&(t.__eventListeners={}),void 0===t.__eventListeners[r]&&(t.__eventListeners[r]=[]),t.__eventListeners[r].push(e)},unregisterEventListener:function(t,e){var r=e.type+"-"+(e.options.capture?"1":"0");if(void 0!==t.__eventListeners&&void 0!==t.__eventListeners[r]){for(var n=t.__eventListeners[r],o=0;o<n.length;o++)n[o].listener===e.listener&&n.splice(o,1);0===n.length&&delete t.__eventListeners[r]}},normalizeListenerCallback:function(e){return"function"==typeof e?e:"object"===(void 0===e?"undefined":U(e))&&"function"==typeof e.handleEvent?e.handleEvent:function(t){e(t)}},normalizeListenerOptions:function(t){switch(void 0===t?"undefined":U(t)){case"boolean":t={capture:t};break;case"undefined":t={capture:!1};break;case"object":break;default:throw new Error("Unsupported options type for addEventListener")}return t.once=Boolean(t.once),t.passive=Boolean(t.passive),t.capture=Boolean(t.capture),t},normalizeListenerArguments:function(t,e,r){return{type:t,listener:this.normalizeListenerCallback(e),options:this.normalizeListenerOptions(r)}},intercept:function(t,e){for(var r=null,n=0;n<this.interceptors.length;n++)this.interceptors[n].target===t&&(r=this.interceptors[n]);null===r?(r={target:t,interceptors:[e]},this.interceptors.push(r),this.interceptAddEventListener(t,r),this.interceptRemoveEventListener(t,r)):r.interceptors.push(e)},interceptAddEventListener:function(t,a){var s=this,c=t.prototype.addEventListener;return t.prototype.addEventListener=function(t,e,r){var n=s.normalizeListenerArguments(t,e,r);if(!s.getRegisteredEventListener(this,n)){n.polyfilled={type:n.type,listener:n.listener,options:{capture:n.options.capture,once:n.options.once,passive:n.options.passive}};for(var o=0;o<a.interceptors.length;o++){var i=a.interceptors[o];"function"==typeof i.add&&i.add(n)}s.registerEventListener(this,n),c.call(this,n.polyfilled.type,n.polyfilled.listener,n.polyfilled.options)}},function(){t.prototype.addEventListener=c}},interceptRemoveEventListener:function(t,e){var i=this,a=t.prototype.removeEventListener;return t.prototype.removeEventListener=function(t,e,r){var n=i.normalizeListenerArguments(t,e,r),o=i.getRegisteredEventListener(this,n);o?(i.unregisterEventListener(this,n),a.call(this,o.polyfilled.type,o.polyfilled.listener,o.polyfilled.options)):a.call(this,t,e,r)},function(){t.prototype.removeEventListener=a}},interceptAll:function(t){this.intercept(EventTarget,t),window instanceof EventTarget||this.intercept(Window,t)},releaseAll:function(){for(var t=0,e=this.interceptors.length;t<e;t++)this.interceptors()},error:function(t){console.error(t)}};return t}()},{}],2:[function(t,e,r){var n;(n=t("./EventListenerInterceptor.js")).isSupportedOnEvent=function(t,e){return"on"+e in t},n.isSupportedTransitionEvent=function(t,e){return n.isSupportedOnEvent(t,e)||"style"in t&&void 0!==t.style.transition},n.isSupportedFullScreenEvent=function(t,e){return!!n.isSupportedOnEvent(t,e)||(/^ms/.test(e.toLowerCase())?"msRequestFullscreen"in document.body:/^moz/.test(e)?"mozRequestFullscreen"in document.body:!!/^webkit/.test(e)&&"webkitRequestFullscreen"in document.body)},n.generateEventTypes=function(){var r=this;this.eventTypes={},this.vendorPrefixes=["","webkit","moz","ms","o"],this.eventTypes.wheel=["wheel","mousewheel","DOMMouseScroll"].map(function(t){return{type:t,isSupported:r.isSupportedOnEvent}}),this.eventTypes.fullscreenchange=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange","msfullscreenchange"].map(function(t){return{type:t,isSupported:r.isSupportedFullScreenEvent}}),this.eventTypes.fullscreenerror=["fullscreenerror","mozfullscreenerror","webkitfullscreenerror","MSFullscreenError","msfullscreenerror"].map(function(t){return{type:t,isSupported:r.isSupportedFullScreenEvent}}),["pointerlockchange","pointerlockerror","animationstart","animationiteration","animationend","pointercancel","pointerdown","pointerhover","pointermove","pointerout","pointerover","pointerup"].forEach(function(e){r.eventTypes[e]=r.vendorPrefixes.map(function(t){return{type:t+e,isSupported:r.isSupportedOnEvent}})}),["transitionstart","transitionrun","transitionend"].forEach(function(e){r.eventTypes[e]=r.vendorPrefixes.map(function(t){return{type:t+e,isSupported:r.isSupportedTransitionEvent}})})},n.getSupportedEventType=function(t,e){var r=this.eventTypes[e];if(void 0===r)return e;for(var n,o=0;o<r.length;o++)if((n=r[o]).isSupported(t,n.type))return n.type;return e},n.polyfillListenerEventTypes=function(){this.generateEventTypes();var e=this;this.interceptAll({add:function(t){t.polyfilled.type=e.getSupportedEventType(this,t.polyfilled.type)}})},n.polyfillListenerEventTypes()},{"./EventListenerInterceptor.js":1}],3:[function(t,e,r){var n;(n=t("./EventListenerInterceptor.js")).detectSupportedOptions=function(){var t=this;this.supportedOptions={once:!1,passive:!1,capture:!1,all:!1,some:!1},document.createDocumentFragment().addEventListener("test",function(){},{get once(){return!(t.supportedOptions.once=!0)},get passive(){return!(t.supportedOptions.passive=!0)},get capture(){return!(t.supportedOptions.capture=!0)}}),this.supportedOptions.all=this.supportedOptions.once&&this.supportedOptions.passive&&this.supportedOptions.capture,this.supportedOptions.some=this.supportedOptions.once||this.supportedOptions.passive||this.supportedOptions.capture},n.polyfillListenerOptions=function(){if(this.detectSupportedOptions(),!this.supportedOptions.all){var t=this;this.interceptAll({add:function(e){var r=e.options.once&&!t.supportedOptions.once,n=e.options.passive&&!t.supportedOptions.passive;if(r||n){var o=e.polyfilled.listener;e.polyfilled.listener=function(t){return r&&this.removeEventListener(e.type,e.listener,e.options),n&&(t.preventDefault=function(){throw new Error("Unable to preventDefault inside passive event listener invocation.")}),o.call(this,t)}}t.supportedOptions.some||(e.polyfilled.options=e.options.capture)}})}},n.polyfillListenerOptions()},{"./EventListenerInterceptor.js":1}],4:[function(t,e,r){e.exports=function(t,e){if("object"===(void 0===e?"undefined":U(e))&&null!==e){var r,n=Object.getPrototypeOf(e);for(r in n)if(!(r in t)){var o=Object.getOwnPropertyDescriptor(n,r);o&&Object.defineProperty(t,r,o)}for(r in e)r in t||(t[r]=e[r])}}},{}],5:[function(t,e,r){!function(n){try{new window.CustomEvent("event",{bubbles:!0,cancelable:!0})}catch(t){var e=window.CustomEvent||window.Event,r=function(t,e){e=e||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,void 0!==e.bubbles&&e.bubbles,void 0!==e.cancelable&&e.cancelable,void 0===e.detail?{}:e.detail),n(r,this),r};r.prototype=e.prototype,window.CustomEvent=r}}(t("./ApplyThisPrototype.js"))},{"./ApplyThisPrototype.js":4}],6:[function(t,e,r){!function(n){try{new window.Event("event",{bubbles:!0,cancelable:!0})}catch(t){var e=window.Event,r=function(t,e){e=e||{};var r=document.createEvent("Event");return r.initEvent(t,void 0!==e.bubbles&&e.bubbles,void 0!==e.cancelable&&e.cancelable,void 0===e.detail?{}:e.detail),n(r,this),r};r.prototype=e.prototype,window.Event=r}}(t("./ApplyThisPrototype.js"))},{"./ApplyThisPrototype.js":4}],7:[function(t,e,r){!function(n){try{new window.FocusEvent("event",{bubbles:!0,cancelable:!0})}catch(t){var e=window.FocusEvent||window.Event,r=function(t,e){e=e||{};var r=document.createEvent("FocusEvent");return r.initFocusEvent(t,void 0!==e.bubbles&&e.bubbles,void 0!==e.cancelable&&e.cancelable,void 0===e.view?window:e.view,void 0===e.detail?{}:e.detail,void 0===e.relatedTarget?null:e.relatedTarget),n(r,this),r};r.prototype=e.prototype,window.FocusEvent=r}}(t("./ApplyThisPrototype.js"))},{"./ApplyThisPrototype.js":4}],8:[function(t,e,r){!function(n){try{new window.KeyboardEvent("event",{bubbles:!0,cancelable:!0})}catch(t){var e=window.KeyboardEvent||window.Event,r=function(t,e){e=e||{};var r=document.createEvent("KeyboardEvent");return r.initKeyboardEvent(t,void 0!==e.bubbles&&e.bubbles,void 0!==e.cancelable&&e.cancelable,void 0===e.view?window:e.view,void 0===e.key?"":e.key,void 0===e.location?0:e.location,(!0===e.ctrlKey?"Control ":"")+(!0===e.altKey?"Alt ":"")+(!0===e.shiftKey?"Shift ":"")+(!0===e.metaKey?"Meta ":""),void 0!==e.repeat&&e.repeat,void 0===e.locale?navigator.language:e.locale),r.keyCode=void 0===e.keyCode?0:e.keyCode,r.code=void 0===e.code?"":e.code,r.charCode=void 0===e.charCode?0:e.charCode,r.char=void 0===e.charCode?"":e.charCode,r.which=void 0===e.which?0:e.which,n(r,this),r};r.prototype=e.prototype,window.KeyboardEvent=r}}(t("./ApplyThisPrototype.js"))},{"./ApplyThisPrototype.js":4}],9:[function(t,e,r){!function(n){try{new window.MouseEvent("event",{bubbles:!0,cancelable:!0})}catch(t){var e=window.MouseEvent||window.Event,r=function(t,e){e=e||{};var r=document.createEvent("MouseEvent");return r.initMouseEvent(t,void 0!==e.bubbles&&e.bubbles,void 0!==e.cancelable&&e.cancelable,void 0===e.view?window:e.view,void 0===e.detail?0:e.detail,void 0===e.screenX?0:e.screenX,void 0===e.screenY?0:e.screenY,void 0===e.clientX?0:e.clientX,void 0===e.clientY?0:e.clientY,void 0!==e.ctrlKey&&e.ctrlKey,void 0!==e.altKey&&e.altKey,void 0!==e.shiftKey&&e.shiftKey,void 0!==e.metaKey&&e.metaKey,void 0===e.button?0:e.button,void 0===e.relatedTarget?null:e.relatedTarget),r.buttons=void 0===e.buttons?0:e.buttons,r.region=void 0===e.region?null:e.region,n(r,this),r};r.prototype=e.prototype,window.MouseEvent=r}}(t("./ApplyThisPrototype.js"))},{"./ApplyThisPrototype.js":4}],10:[function(t,e,r){!function(n){try{new window.PointerEvent("event",{bubbles:!0,cancelable:!0})}catch(t){var e=window.PointerEvent||window.Event,r=function(t,e){e=e||{};var r=document.createEvent("PointerEvent");return r.initPointerEvent(t,void 0!==e.bubbles&&e.bubbles,void 0!==e.cancelable&&e.cancelable,void 0===e.view?window:e.view,void 0===e.detail?0:e.detail,void 0===e.screenX?0:e.screenX,void 0===e.screenY?0:e.screenY,void 0===e.clientX?0:e.clientX,void 0===e.clientY?0:e.clientY,void 0!==e.ctrlKey&&e.ctrlKey,void 0!==e.altKey&&e.altKey,void 0!==e.shiftKey&&e.shiftKey,void 0!==e.metaKey&&e.metaKey,void 0===e.button?0:e.button,void 0===e.relatedTarget?null:e.relatedTarget,void 0===e.offsetX?0:e.offsetX,void 0===e.offsetY?0:e.offsetY,void 0===e.width?1:e.width,void 0===e.height?1:e.height,void 0===e.pressure?0:e.pressure,void 0===e.twist?0:e.twist,void 0===e.tiltX?0:e.tiltX,void 0===e.tiltY?0:e.tiltY,void 0===e.pointerId?0:e.pointerId,void 0===e.pointerType?"":e.pointerType,void 0===e.hwTimestamp?0:e.hwTimestamp,void 0!==e.isPrimary&&e.isPrimary),r.tangentialPressure=void 0===e.tangentialPressure?0:e.tangentialPressure,n(r,this),r};r.prototype=e.prototype;var o=Object.getOwnPropertyDescriptor(r.prototype,"rotation");o&&Object.defineProperty(r.prototype,"twist",o),window.PointerEvent=r}}(t("./ApplyThisPrototype.js"))},{"./ApplyThisPrototype.js":4}],11:[function(t,e,r){t("./Event.js"),t("./CustomEvent.js"),t("./MouseEvent.js"),t("./KeyboardEvent.js"),t("./FocusEvent.js"),t("./PointerEvent.js")},{"./CustomEvent.js":5,"./Event.js":6,"./FocusEvent.js":7,"./KeyboardEvent.js":8,"./MouseEvent.js":9,"./PointerEvent.js":10}],12:[function(t,e,r){t("./constructors/index.js"),t("./ListenerOptions.js"),t("./ListenerEventTypes.js")},{"./ListenerEventTypes.js":2,"./ListenerOptions.js":3,"./constructors/index.js":11}]},{},[12]);var i="function"==typeof fetch?fetch.bind():function(o,i){return i=i||{},new Promise(function(t,e){var r=new XMLHttpRequest;for(var n in r.open(i.method||"get",o),i.headers)r.setRequestHeader(n,i.headers[n]);function s(){var n,o=[],i=[],a={};return r.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(t,e,r){o.push(e=e.toLowerCase()),i.push([e,r]),n=a[e],a[e]=n?n+","+r:r}),{ok:1==(r.status/200|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:s,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([r.response]))},headers:{keys:function(){return o},entries:function(){return i},get:function(t){return a[t.toLowerCase()]},has:function(t){return t.toLowerCase()in a}}}}r.withCredentials="include"==i.credentials,r.onload=function(){t(s())},r.onerror=e,r.send(i.body)})};e(function(k){!function(t){var c,e=Object.prototype,u=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",n=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag",a=t.regeneratorRuntime;if(a)k.exports=a;else{(a=t.regeneratorRuntime=k.exports).wrap=m;var p="suspendedStart",f="suspendedYield",d="executing",v="completed",h={},s={};s[o]=function(){return this};var l=Object.getPrototypeOf,y=l&&l(l(x([])));y&&y!==e&&u.call(y,o)&&(s=y);var b=j.prototype=w.prototype=Object.create(s);_.prototype=b.constructor=j,j.constructor=_,j[i]=_.displayName="GeneratorFunction",a.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,j):(t.__proto__=j,i in t||(t[i]="GeneratorFunction")),t.prototype=Object.create(b),t},a.awrap=function(t){return{__await:t}},L(E.prototype),E.prototype[n]=function(){return this},a.AsyncIterator=E,a.async=function(t,e,r,n){var o=new E(m(t,e,r,n));return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},L(b),b[i]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},a.keys=function(r){var n=[];for(var t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return i.type="throw",i.arg=r,n.next=t,e&&(n.method="next",n.arg=c),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=u.call(o,"catchLoc"),s=u.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=c),h}}}function m(t,e,r,n){var i,a,s,c,o=e&&e.prototype instanceof w?e:w,u=Object.create(o.prototype),l=new S(n||[]);return u._invoke=(i=t,a=r,s=l,c=p,function(t,e){if(c===d)throw new Error("Generator is already running");if(c===v){if("throw"===t)throw e;return P()}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r){var n=O(r,s);if(n){if(n===h)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(c===p)throw c=v,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);c=d;var o=g(i,a,s);if("normal"===o.type){if(c=s.done?v:f,o.arg===h)continue;return{value:o.arg,done:s.done}}"throw"===o.type&&(c=v,s.method="throw",s.arg=o.arg)}}),u}function g(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function w(){}function _(){}function j(){}function L(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function E(c){var e;this._invoke=function(r,n){function t(){return new Promise(function(t,e){!function e(t,r,n,o){var i=g(c[t],c,r);if("throw"!==i.type){var a=i.arg,s=a.value;return s&&"object"===(void 0===s?"undefined":U(s))&&u.call(s,"__await")?Promise.resolve(s.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):Promise.resolve(s).then(function(t){a.value=t,n(a)},o)}o(i.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function O(t,e){var r=t.iterator[e.method];if(r===c){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=c,O(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=g(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,h;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=c),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function x(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=c,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:c,done:!0}}}(function(){return this}()||Function("return this")())});function p(a,s){return function(t){var e,r,n,o="function"==typeof s.metric?s.metric:function(t){return t[s.metric]};s.scheme&&0!==(n=s.scheme).lastIndexOf("scheme",0)&&(n="interpolate"+n),r=s.scale?s.scale.replace(/\w+/g,function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()}):n?"Sequential":"Linear";var i=s.domain||d3.extent(a,o);return n?e=d3["scale"+r](d3[n]).domain(i):s.range&&(e=d3["scale"+r]().domain(i).range(s.range)),e(o(t))}}var c=function(t){return!(!(n=t)||"object"!==(void 0===n?"undefined":U(n))||(e=t,"[object RegExp]"===(r=Object.prototype.toString.call(e))||"[object Date]"===r||e.$$typeof===a));var e,r,n};var a="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function u(t,e){return!1!==e.clone&&e.isMergeableObject(t)?d((r=t,Array.isArray(r)?[]:{}),t,e):t;var r}function f(t,e,r){return t.concat(e).map(function(t){return u(t,r)})}function d(t,e,r){(r=r||{}).arrayMerge=r.arrayMerge||f,r.isMergeableObject=r.isMergeableObject||c;var n,o,i,a,s=Array.isArray(e);return s===Array.isArray(t)?s?r.arrayMerge(t,e,r):(n=t,o=e,a={},(i=r).isMergeableObject(n)&&Object.keys(n).forEach(function(t){a[t]=u(n[t],i)}),Object.keys(o).forEach(function(t){i.isMergeableObject(o[t])&&n[t]?a[t]=d(n[t],o[t],i):a[t]=u(o[t],i)}),a):u(e,r)}d.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,e){return d(t,e,r)},{})};var s=d;var r=function(){this.__data__=[],this.size=0};var v=function(t,e){return t===e||t!=t&&e!=e};var h=function(t,e){for(var r=t.length;r--;)if(v(t[r][0],e))return r;return-1},n=Array.prototype.splice;var y=function(t){var e=this.__data__,r=h(e,t);return!(r<0||(r==e.length-1?e.pop():n.call(e,r,1),--this.size,0))};var b=function(t){var e=this.__data__,r=h(e,t);return r<0?void 0:e[r][1]};var m=function(t){return-1<h(this.__data__,t)};var g=function(t,e){var r=this.__data__,n=h(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function w(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}w.prototype.clear=r,w.prototype.delete=y,w.prototype.get=b,w.prototype.has=m,w.prototype.set=g;var _=w;var j=function(){this.__data__=new _,this.size=0};var E=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var O=function(t){return this.__data__.get(t)};var A=function(t){return this.__data__.has(t)},T="object"==U(R)&&R&&R.Object===Object&&R,S="object"==("undefined"==typeof self?"undefined":U(self))&&self&&self.Object===Object&&self,x=T||S||Function("return this")(),P=x.Symbol,k=Object.prototype,M=k.hasOwnProperty,C=k.toString,F=P?P.toStringTag:void 0;var D=function(t){var e=M.call(t,F),r=t[F];try{var n=!(t[F]=void 0)}catch(t){}var o=C.call(t);return n&&(e?t[F]=r:delete t[F]),o},z=Object.prototype.toString;var K=function(t){return z.call(t)},N="[object Null]",I="[object Undefined]",B=P?P.toStringTag:void 0;var Y=function(t){return null==t?void 0===t?I:N:B&&B in Object(t)?D(t):K(t)};var G=function(t){var e=void 0===t?"undefined":U(t);return null!=t&&("object"==e||"function"==e)},q="[object AsyncFunction]",X="[object Function]",$="[object GeneratorFunction]",W="[object Proxy]";var J,V=function(t){if(!G(t))return!1;var e=Y(t);return e==X||e==$||e==q||e==W},H=x["__core-js_shared__"],Z=(J=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+J:"";var Q=function(t){return!!Z&&Z in t},tt=Function.prototype.toString;var et=function(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},rt=/^\[object .+?Constructor\]$/,nt=Function.prototype,ot=Object.prototype,it=nt.toString,at=ot.hasOwnProperty,st=RegExp("^"+it.call(at).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ct=function(t){return!(!G(t)||Q(t))&&(V(t)?st:rt).test(et(t))};var ut=function(t,e){return null==t?void 0:t[e]};var lt=function(t,e){var r=ut(t,e);return ct(r)?r:void 0},pt=lt(x,"Map"),ft=lt(Object,"create");var dt=function(){this.__data__=ft?ft(null):{},this.size=0};var vt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ht="__lodash_hash_undefined__",yt=Object.prototype.hasOwnProperty;var bt=function(t){var e=this.__data__;if(ft){var r=e[t];return r===ht?void 0:r}return yt.call(e,t)?e[t]:void 0},mt=Object.prototype.hasOwnProperty;var gt=function(t){var e=this.__data__;return ft?void 0!==e[t]:mt.call(e,t)},wt="__lodash_hash_undefined__";var _t=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ft&&void 0===e?wt:e,this};function jt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}jt.prototype.clear=dt,jt.prototype.delete=vt,jt.prototype.get=bt,jt.prototype.has=gt,jt.prototype.set=_t;var Lt=jt;var Et=function(t){var e=void 0===t?"undefined":U(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Ot=function(t,e){var r=t.__data__;return Et(e)?r["string"==typeof e?"string":"hash"]:r.map};var At=function(t){var e=Ot(this,t).delete(t);return this.size-=e?1:0,e};var Tt=function(t){return Ot(this,t).get(t)};var St=function(t){return Ot(this,t).has(t)};var xt=function(t,e){var r=Ot(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Pt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Pt.prototype.clear=function(){this.size=0,this.__data__={hash:new Lt,map:new(pt||_),string:new Lt}},Pt.prototype.delete=At,Pt.prototype.get=Tt,Pt.prototype.has=St,Pt.prototype.set=xt;var kt=Pt,Mt=200;var Ct=function(t,e){var r=this.__data__;if(r instanceof _){var n=r.__data__;if(!pt||n.length<Mt-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new kt(n)}return r.set(t,e),this.size=r.size,this};function Ft(t){var e=this.__data__=new _(t);this.size=e.size}Ft.prototype.clear=j,Ft.prototype.delete=E,Ft.prototype.get=O,Ft.prototype.has=A,Ft.prototype.set=Ct;var Dt=Ft;var zt=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},Kt=function(){try{var t=lt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Nt=function(t,e,r){"__proto__"==e&&Kt?Kt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},It=Object.prototype.hasOwnProperty;var Rt=function(t,e,r){var n=t[e];It.call(t,e)&&v(n,r)&&(void 0!==r||e in t)||Nt(t,e,r)};var Ut=function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=n?n(r[s],t[s],s,r,t):void 0;void 0===c&&(c=t[s]),o?Nt(r,s,c):Rt(r,s,c)}return r};var Bt=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Yt=function(t){return null!=t&&"object"==(void 0===t?"undefined":U(t))},Gt="[object Arguments]";var qt=function(t){return Yt(t)&&Y(t)==Gt},Xt=Object.prototype,$t=Xt.hasOwnProperty,Wt=Xt.propertyIsEnumerable,Jt=qt(function(){return arguments}())?qt:function(t){return Yt(t)&&$t.call(t,"callee")&&!Wt.call(t,"callee")},Vt=Array.isArray;var Ht=function(){return!1},Zt=e(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?x.Buffer:void 0,i=(o?o.isBuffer:void 0)||Ht;t.exports=i}),Qt=9007199254740991,te=/^(?:0|[1-9]\d*)$/;var ee=function(t,e){var r=void 0===t?"undefined":U(t);return!!(e=null==e?Qt:e)&&("number"==r||"symbol"!=r&&te.test(t))&&-1<t&&t%1==0&&t<e},re=9007199254740991;var ne=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=re},oe={};oe["[object Float32Array]"]=oe["[object Float64Array]"]=oe["[object Int8Array]"]=oe["[object Int16Array]"]=oe["[object Int32Array]"]=oe["[object Uint8Array]"]=oe["[object Uint8ClampedArray]"]=oe["[object Uint16Array]"]=oe["[object Uint32Array]"]=!0,oe["[object Arguments]"]=oe["[object Array]"]=oe["[object ArrayBuffer]"]=oe["[object Boolean]"]=oe["[object DataView]"]=oe["[object Date]"]=oe["[object Error]"]=oe["[object Function]"]=oe["[object Map]"]=oe["[object Number]"]=oe["[object Object]"]=oe["[object RegExp]"]=oe["[object Set]"]=oe["[object String]"]=oe["[object WeakMap]"]=!1;var ie=function(t){return Yt(t)&&ne(t.length)&&!!oe[Y(t)]};var ae=function(e){return function(t){return e(t)}},se=e(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&T.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i}),ce=se&&se.isTypedArray,ue=ce?ae(ce):ie,le=Object.prototype.hasOwnProperty;var pe=function(t,e){var r=Vt(t),n=!r&&Jt(t),o=!r&&!n&&Zt(t),i=!r&&!n&&!o&&ue(t),a=r||n||o||i,s=a?Bt(t.length,String):[],c=s.length;for(var u in t)!e&&!le.call(t,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ee(u,c))||s.push(u);return s},fe=Object.prototype;var de=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||fe)};var ve=function(e,r){return function(t){return e(r(t))}},he=ve(Object.keys,Object),ye=Object.prototype.hasOwnProperty;var be=function(t){if(!de(t))return he(t);var e=[];for(var r in Object(t))ye.call(t,r)&&"constructor"!=r&&e.push(r);return e};var me=function(t){return null!=t&&ne(t.length)&&!V(t)};var ge=function(t){return me(t)?pe(t):be(t)};var we=function(t,e){return t&&Ut(e,ge(e),t)};var _e=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},je=Object.prototype.hasOwnProperty;var Le=function(t){if(!G(t))return _e(t);var e=de(t),r=[];for(var n in t)("constructor"!=n||!e&&je.call(t,n))&&r.push(n);return r};var Ee=function(t){return me(t)?pe(t,!0):Le(t)};var Oe=function(t,e){return t&&Ut(e,Ee(e),t)},Ae=e(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?x.Buffer:void 0,i=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=i?i(r):new t.constructor(r);return t.copy(n),n}});var Te=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Se=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i};var xe=function(){return[]},Pe=Object.prototype.propertyIsEnumerable,ke=Object.getOwnPropertySymbols,Me=ke?function(e){return null==e?[]:(e=Object(e),Se(ke(e),function(t){return Pe.call(e,t)}))}:xe;var Ce=function(t,e){return Ut(t,Me(t),e)};var Fe=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},De=ve(Object.getPrototypeOf,Object),ze=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Fe(e,Me(t)),t=De(t);return e}:xe;var Ke=function(t,e){return Ut(t,ze(t),e)};var Ne=function(t,e,r){var n=e(t);return Vt(t)?n:Fe(n,r(t))};var Ie=function(t){return Ne(t,ge,Me)};var Re=function(t){return Ne(t,Ee,ze)},Ue=lt(x,"DataView"),Be=lt(x,"Promise"),Ye=lt(x,"Set"),Ge=lt(x,"WeakMap"),qe="[object Map]",Xe="[object Promise]",$e="[object Set]",We="[object WeakMap]",Je="[object DataView]",Ve=et(Ue),He=et(pt),Ze=et(Be),Qe=et(Ye),tr=et(Ge),er=Y;(Ue&&er(new Ue(new ArrayBuffer(1)))!=Je||pt&&er(new pt)!=qe||Be&&er(Be.resolve())!=Xe||Ye&&er(new Ye)!=$e||Ge&&er(new Ge)!=We)&&(er=function(t){var e=Y(t),r="[object Object]"==e?t.constructor:void 0,n=r?et(r):"";if(n)switch(n){case Ve:return Je;case He:return qe;case Ze:return Xe;case Qe:return $e;case tr:return We}return e});var rr=er,nr=Object.prototype.hasOwnProperty;var or=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&nr.call(t,"index")&&(r.index=t.index,r.input=t.input),r},ir=x.Uint8Array;var ar=function(t){var e=new t.constructor(t.byteLength);return new ir(e).set(new ir(t)),e};var sr=function(t,e){var r=e?ar(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},cr=/\w*$/;var ur=function(t){var e=new t.constructor(t.source,cr.exec(t));return e.lastIndex=t.lastIndex,e},lr=P?P.prototype:void 0,pr=lr?lr.valueOf:void 0;var fr=function(t){return pr?Object(pr.call(t)):{}};var dr=function(t,e){var r=e?ar(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)},vr="[object Boolean]",hr="[object Date]",yr="[object Map]",br="[object Number]",mr="[object RegExp]",gr="[object Set]",wr="[object String]",_r="[object Symbol]",jr="[object ArrayBuffer]",Lr="[object DataView]",Er="[object Float32Array]",Or="[object Float64Array]",Ar="[object Int8Array]",Tr="[object Int16Array]",Sr="[object Int32Array]",xr="[object Uint8Array]",Pr="[object Uint8ClampedArray]",kr="[object Uint16Array]",Mr="[object Uint32Array]";var Cr=function(t,e,r){var n=t.constructor;switch(e){case jr:return ar(t);case vr:case hr:return new n(+t);case Lr:return sr(t,r);case Er:case Or:case Ar:case Tr:case Sr:case xr:case Pr:case kr:case Mr:return dr(t,r);case yr:return new n;case br:case wr:return new n(t);case mr:return ur(t);case gr:return new n;case _r:return fr(t)}},Fr=Object.create,Dr=function(){function r(){}return function(t){if(!G(t))return{};if(Fr)return Fr(t);r.prototype=t;var e=new r;return r.prototype=void 0,e}}();var zr=function(t){return"function"!=typeof t.constructor||de(t)?{}:Dr(De(t))},Kr="[object Map]";var Nr=function(t){return Yt(t)&&rr(t)==Kr},Ir=se&&se.isMap,Rr=Ir?ae(Ir):Nr,Ur="[object Set]";var Br=function(t){return Yt(t)&&rr(t)==Ur},Yr=se&&se.isSet,Gr=Yr?ae(Yr):Br,qr=1,Xr=2,$r=4,Wr="[object Arguments]",Jr="[object Function]",Vr="[object GeneratorFunction]",Hr="[object Object]",Zr={};Zr[Wr]=Zr["[object Array]"]=Zr["[object ArrayBuffer]"]=Zr["[object DataView]"]=Zr["[object Boolean]"]=Zr["[object Date]"]=Zr["[object Float32Array]"]=Zr["[object Float64Array]"]=Zr["[object Int8Array]"]=Zr["[object Int16Array]"]=Zr["[object Int32Array]"]=Zr["[object Map]"]=Zr["[object Number]"]=Zr[Hr]=Zr["[object RegExp]"]=Zr["[object Set]"]=Zr["[object String]"]=Zr["[object Symbol]"]=Zr["[object Uint8Array]"]=Zr["[object Uint8ClampedArray]"]=Zr["[object Uint16Array]"]=Zr["[object Uint32Array]"]=!0,Zr["[object Error]"]=Zr[Jr]=Zr["[object WeakMap]"]=!1;var Qr=function r(n,o,i,t,e,a){var s,c=o&qr,u=o&Xr,l=o&$r;if(i&&(s=e?i(n,t,e,a):i(n)),void 0!==s)return s;if(!G(n))return n;var p=Vt(n);if(p){if(s=or(n),!c)return Te(n,s)}else{var f=rr(n),d=f==Jr||f==Vr;if(Zt(n))return Ae(n,c);if(f==Hr||f==Wr||d&&!e){if(s=u||d?{}:zr(n),!c)return u?Ke(n,Oe(s,n)):Ce(n,we(s,n))}else{if(!Zr[f])return e?n:{};s=Cr(n,f,c)}}a||(a=new Dt);var v=a.get(n);if(v)return v;if(a.set(n,s),Gr(n))return n.forEach(function(t){s.add(r(t,o,i,t,n,a))}),s;if(Rr(n))return n.forEach(function(t,e){s.set(e,r(t,o,i,e,n,a))}),s;var h=l?u?Re:Ie:u?keysIn:ge,y=p?void 0:h(n);return zt(y||n,function(t,e){y&&(t=n[e=t]),Rt(s,e,r(t,o,i,e,n,a))}),s},tn=1,en=4;var rn=function(t){return Qr(t,tn|en)},nn=function(t){return null!=t&&"object"===(void 0===t?"undefined":U(t))&&!1===Array.isArray(t)};function on(t){return!0===nn(t)&&"[object Object]"===Object.prototype.toString.call(t)}var an=function(t){var e,r;return!1!==on(t)&&("function"==typeof(e=t.constructor)&&(!1!==on(r=e.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))};window.Promise||(window.Promise=Promise);var sn={map:{center:[0,0],zoom:1},cache:!0},cn=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=this;if(r.gData={},r.gLayers={},r._dataLayerMap={},r.options=e,r.mapDiv="string"==typeof r.options.id?document.getElementById(r.options.id):r.options.id,r.options=s(sn,r.options,{isMergeableObject:an}),r.map=L.map(r.options.id,r.options.map),r.options.layers){for(var n in r.options.layers)r.gLayers[n]=void 0;for(var o in r.options.layers)r.buildLayer(o,r.options.layers[o]);r.drilldown(),r.current_level=0,r.drilldown_stack=[]}r.options.legend&&r.legend(r.options.legend).addTo(r.map)};function un(t){if(t.hasOwnProperty("data"))return"data";if(t.hasOwnProperty("url"))return"url";throw new Error("layer MUST have a data as an (array of objects) or a url (string).")}function ln(e,r,t){r&&t.forEach(function(t){"function"==typeof r[t]&&(r[t]=r[t](e.feature.properties))})}cn.prototype.addLegend=function(o){var t={position:"bottomright",height:200,width:200,shapeWidth:20,shapePadding:20,labelOffset:20,format:"d",shape:d3.symbolSquare,orient:"vertical",size:150,cells:5};o=Object.assign(t,o);var e=L.control({position:o.position});return e.onAdd=function(t){var e=document.createElement("div"),r=d3.select(e).attr("class","map-legend").append("svg").attr("height",o.height).attr("width",o.width),n=d3.legendColor().shapeWidth(o.shapeWidth).shapePadding(o.shapePadding).labelOffset(o.labelOffset).labelFormat(o.format).cells(o.cells).orient(o.orient).scale(o.scale);return o.shape&&n.shape("path",d3.symbol().type(o.shape).size(o.size)()),r.append("g").attr("class","legend").attr("transform","translate(10,10)").call(n),e},e},cn.prototype.cacheData=function(e,r){var n=this;switch(void 0===r?"undefined":U(r)){case"string":return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r in n.gData&&n.options.cache){t.next=6;break}return t.next=3,i(r);case 3:return t.next=5,t.sent.json();case 5:n.gData[r]=t.sent;case 6:return r in n._dataLayerMap?n._dataLayerMap[r].push(e):n._dataLayerMap[r]=[e],t.abrupt("return",n.gData[r]);case 8:case"end":return t.stop()}},t,this)}))();case"object":return this.gData[function(t){var e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return e>>>0}(JSON.stringify(r))]=r,o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r);case 1:case"end":return t.stop()}},t,this)}))()}},cn.prototype._saveLayer=function(t,e){var r=this;(r.gLayers[t]=e,r.gLayers[t].addTo(r.map),"layers"in r.options)&&(0==Object.keys(r.gLayers).filter(function(t){return!r.gLayers[t]}).length&&r.fire("layersloaded"),r.renderTooltip(t,r.options.layers[t]),r.renderPopup(t,r.options.layers[t]))},cn.prototype.addMismatchLabel=function(t){var e={style:{color:"black",padding:"5px",border:"2px solid #cccccc","border-radius":"10px","background-color":"#ffffff"},position:"bottomleft"},r=document.createElement("div");r.setAttribute("class","mismatch-log"),r.innerHTML=t+" Mismatches found!",e.html=r;this.addNote(e)},cn.prototype.addNote=function(e){var t=L.control({position:e.position||"bottomleft"});t.onAdd=function(t){return e.style&&function(t,e){for(var r in e)t.style[r]=e[r]}(e.html,e.style),e.html},t.addTo(this.map)},cn.prototype.mergeData=function(t,e,i){var a={};function r(t){var e="string"==typeof t.properties[i.mapKey]?t.properties[i.mapKey].toLowerCase():t.properties[i.mapKey],r=a[e],n={isMatched:!0,feature:t};for(var o in r)t.properties[o]=r[o];return void 0===r&&(n.isMatched=!1),n}e.forEach(function(t){var e="string"==typeof t[i.dataKey]?t[i.dataKey].toLowerCase():t[i.dataKey];a[e]=t});var n="";switch(t.type){case"Feature":case"FeatureCollection":return(n=t.features.map(r).filter(function(t){return!t.isMatched}))&&0<n.length&&(i.mismatch&&"function"==typeof i.mismatch?i.mismatch(n):i&&!i.mismatch&&this.addMismatchLabel(n.length)),t;case"Topology":return(n=t.objects[Object.keys(t.objects)[0]].geometries.map(r).filter(function(t){return!t.isMatched}))&&0<n.length&&(i.mismatch&&"function"==typeof i.mismatch?i.mismatch(n):i&&!i.mismatch&&this.addMismatchLabel(n.length)),t;default:return t.map(function(t){var e=a[t[i.mapKey]];for(var r in e)t[r]=e[r]}),t}},cn.prototype.fire=function(t){this.mapDiv.dispatchEvent(new CustomEvent(t))},cn.prototype.on=function(t,e,r){this.mapDiv.addEventListener(t,e,r)},cn.prototype.off=function(t,e,r){this.mapDiv.removeEventListener(t,e,r)},cn.prototype.buildLayer=function(o,i){var r,a=this;switch(o in a.options||(a.options.layers[o]=i),a.map.hasLayer(a.gLayers[o])&&a.map.removeLayer(a.gLayers[o]),i.type.toLowerCase()){case"tile":r=L.tileLayer(i.url,i.options),this._saveLayer(o,r),a.fire(o+"loaded");break;case"topojson":case"geojson":a.cacheData(o,i[un(i)]).then(function(e){"link"in i?a.cacheData(o,i.link[un(i.link)]).then(function(t){a.mismatch_array=[],a.mergeData(e,t,i.link),r=new L.TopoJSON(e,i.options),a._saveLayer(o,r),"attrs"in i&&a._choropleth(o,i),a.fitToLayer(o),a.fire(o+"loaded")}):(r=new L.TopoJSON(e,i.options),a._saveLayer(o,r),"attrs"in i&&a._choropleth(o,i),a.fitToLayer(o),a.fire(o+"loaded"))});break;case"marker":var n=[];a.cacheData(o,i[un(i)]).then(function(t){t.forEach(function(t){var e=L.marker([t[i.latitude],t[i.longitude]],i.options);e.feature={},e.feature.properties=t,n.push(e)}),a.fitToLayer(L.featureGroup(n)),a._saveLayer(o,L.featureGroup(n)),a.fire(o+"loaded")});break;case"circle":case"circlemarker":var s="circle"===i.type.toLowerCase()?L.circle:L.circleMarker;a.cacheData(o,i[un(i)]).then(function(e){var r=[];function n(){e.forEach(function(t){var e=s([t[i.latitude],t[i.longitude]],i.options);e.feature={},e.feature.properties=t,r.push(e)}),a._saveLayer(o,L.featureGroup(r))}"link"in i?a.cacheData(o,i.link[un(i.link)]).then(function(t){a.mergeData(e,t,i.link),n(),"attrs"in i&&a._choropleth(o,i),a.fitToLayer(o)}):(n(),"attrs"in i&&a._choropleth(o,i),a.fitToLayer(o))});break;default:throw new Error("Invalid layer type")}},cn.prototype.removeLayer=function(t){var e=this;if(e.map.hasLayer(e.gLayers[t])&&e.gLayers[t]){var r=e.gLayers[t];return e.map.removeLayer(r),r}throw new Error("Layer "+t+" is not available")},cn.prototype.addLayer=function(t,e){var r=this;if(t&&e)r.buildLayer(t,e);else{if(!r.gLayers[t]||r.map.hasLayer(r.gLayers[t]))throw new Error("Layer "+t+" is already existed or not created");r.map.addLayer(r.gLayers[t])}},cn.prototype._choropleth=function(t,a,s){var c=this.gLayers[t],u=this;c.eachLayer(function(t){var e,r,n,o,i={};if(a.options&&a.options.style&&t.setStyle(a.options.style),!s||"function"!=typeof s||!1!==s(t.feature.properties)){for(e in a.attrs)"tooltip"!=e&&"tooltipOptions"!=e&&("object"==U(a.attrs[e])?(r="string"==typeof(n=a.attrs[e].metric)?function(t){return t[n]}:n,o=a.attrs[e].domain?a.attrs[e].domain:u._calculateMinMax(c,r),void 0!==r(t.feature.properties)&&(i[e]=p([],{metric:n,domain:o,scheme:a.attrs[e].scheme,scale:a.attrs[e].scale,range:a.attrs[e].range})(t.feature.properties))):i[e]=a.attrs[e]);t.setStyle(i)}}),a.legend&&(u.mapDiv.querySelector(".map-legend")&&u.mapDiv.querySelector(".map-legend").remove(),u.addLegend(a.legend).addTo(u.map))},cn.prototype._calculateMinMax=function(t,r){var n,o;return t.eachLayer(function(t){var e=r(t.feature.properties);e&&(o&&n||(n=o=e),e<n&&(n=e),o<e&&(o=e))}),[n,o]},cn.prototype.drilldown=function(t){var e=this;e.on("layersloaded",function(){e.options.drilldown&&(e.drilldown_stack.push(e.options.drilldown.rootLayer),e.drilldown_recursive(e.options.drilldown.rootLayer))},{once:!0})},cn.prototype.drilldown_recursive=function(r){var n=this,o=rn(n.options.drilldown.levels);n.gLayers[r].eachLayer(function(e){e.on("click",function(){if(e.off("click"),o.length==n.current_level)n.fitToLayer(e);else{var t=rn(o[n.current_level]);ln(e,t,["layerName"]),ln(e,t.layerOptions,["url","data"]),ln(e,t.layerOptions.link,["url","data"]),n.options.layers[t.layerName]=t.layerOptions,n.buildLayer(t.layerName,t.layerOptions),n.map.removeLayer(n.gLayers[r]),n.drilldown_stack.push(t.layerName),n.current_level+=1,n.on(t.layerName+"loaded",function(){n.renderTooltip(t.layerName,t.layerOptions),n.drilldown_recursive(t.layerName)},{once:!0})}})})},cn.prototype.drillup=function(){var t=this;if(0!=t.current_level){t.current_level-=1,t.map.removeLayer(t.gLayers[t.drilldown_stack.pop()]);var e=t.drilldown_stack[t.drilldown_stack.length-1];t.fitToLayer(t.gLayers[e]),t.gLayers[e].addTo(t.map),t.drilldown_recursive(e)}},cn.prototype.renderPopup=function(t,r){if(r.popup){var n=r.popupOptions?r.popupOptions:{};this.gLayers[t].eachLayer(function(t){var e="function"==typeof r.popup?r.popup(t.feature.properties):r.popup;t.bindPopup(e,n)})}},cn.prototype.renderTooltip=function(t,i){if(i.tooltip){var a=this,s=i.tooltipOptions?i.tooltipOptions:{},c=a.map.latLngToContainerPoint(a.gLayers[t].getBounds().getCenter());a.gLayers[t].eachLayer(function(t){var e="function"==typeof i.tooltip?i.tooltip(t.feature.properties):i.tooltip,r=Object.assign({},s);if("function"==typeof s.direction){var n="marker"==i.type.toLowerCase()?[t.getLatLng().lat,t.getLatLng().lng]:t.getBounds().getCenter(),o=a.map.latLngToContainerPoint(n);r.direction=s.direction({centerPoint:c,tooltipPoint:o,properties:t.feature.properties})}t.bindTooltip(e,r)})}},cn.prototype.zoomHandler=function(t,e,r){var n=this;n.map.on("zoom",function(){r=r||n.map.getMaxZoom(),n.map.getZoom()<e||n.map.getZoom()>r?n.map.hasLayer(n.gLayers[t])&&n.map.removeLayer(n.gLayers[t]):n.map.hasLayer(n.gLayers[t])||n.map.addLayer(n.gLayers[t])})},cn.prototype.fitToLayer=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.options.fitbounds,r="string"==typeof t?this.gLayers[t]:t;this.map.fitBounds(r.getBounds(),e)},L.TopoJSON=L.GeoJSON.extend({addData:function(t){var e,r;if("Topology"===t.type)for(e in t.objects)r=topojson.feature(t,t.objects[e]),L.GeoJSON.prototype.addData.call(this,r);else L.GeoJSON.prototype.addData.call(this,t);return this}}),t.version="0.16.2",t.MapViewer=cn,t.mapviewer=function(t){return new cn(t)},Object.defineProperty(t,"__esModule",{value:!0})});
